<div class="container">
  <div class="grid">
    <div class="col-12">
      <div class="search-container">
        <h2 class="section-title">Explore Movies</h2>
        <div class="p-fluid">
          <span class="p-input-icon-left">
            <i class="pi pi-search"></i>
            <input type="text" pInputText placeholder="Search for movies..." [(ngModel)]="searchValue"
              (change)="searchChanged()" class="search-input" />
          </span>
        </div>
      </div>
    </div>
  </div>
  <div class="grid" *ngIf="!genreId && !searchValue">
    <div class="col-12">
      <div class="categories-tabs">
        <button *ngFor="let cat of categories" class="category-tab" [class.active]="category === cat.value"
          (click)="changeCategory(cat.value)">
          {{ cat.name }}
        </button>
      </div>
    </div>
  </div>

  <!-- Content Section: Sidebar and Grid -->
  <div class="grid">
    <!-- Filters Sidebar/Top Bar -->
    <div class="col-12 filters-sidebar" *ngIf="!genreId && !searchValue">
      <div class="filters-column">
        <!-- Row 1: Sort and Watch -->
        <div class="filters-row top-row">
          <!-- Sort Panel -->
          <div class="filter-card sort-card">
            <p-accordion>
              <p-accordionTab header="Sort">
                <div class="p-field">
                  <label class="block mb-2 text-sm text-gray-400">Sort Results By</label>
                  <p-dropdown [options]="sortOptions" [(ngModel)]="sortBy" optionLabel="label" optionValue="value"
                    placeholder="Popularity Descending" styleClass="w-full">
                  </p-dropdown>
                </div>
              </p-accordionTab>
            </p-accordion>
          </div>

          <!-- Where To Watch Panel -->
          <div class="filter-card watch-card">
            <p-accordion>
              <p-accordionTab header="Where To Watch">
                <div class="text-gray-400 text-sm">My Services (Coming Soon)</div>
              </p-accordionTab>
            </p-accordion>
          </div>
        </div>

        <!-- Row 2: Main Filters Panel -->
        <div class="filters-row bottom-row">
          <div class="filter-card main-filters-card">
            <div class="filter-header">
              <h3>Filters</h3>
            </div>
            <div class="filter-content">
              <p-accordion [multiple]="true" [activeIndex]="[0,1,2]">
                <!-- Show Me -->
                <p-accordionTab header="Show Me">
                  <div class="field-radio mb-2">
                    <p-radioButton name="showMe" value="everything" label="Everything"
                      [(ngModel)]="showMeValue"></p-radioButton>
                  </div>
                  <div class="field-radio mb-2">
                    <p-radioButton name="showMe" value="seen" label="Movies I Have Seen"
                      [(ngModel)]="showMeValue"></p-radioButton>
                  </div>
                </p-accordionTab>

                <!-- Release Dates -->
                <p-accordionTab header="Release Dates">
                  <div class="flex flex-column gap-3">
                    <div class="flex align-items-center">
                      <p-checkbox [binary]="true" label="Search all releases?" [disabled]="true"></p-checkbox>
                    </div>
                    <div class="date-range-grid">
                      <div class="field">
                        <label>from</label>
                        <p-calendar [(ngModel)]="startDate" (onSelect)="applyFilters()" dateFormat="yy-mm-dd"
                          placeholder="Start Date" [showIcon]="true" appendTo="body"></p-calendar>
                      </div>
                      <div class="date-range-grid mt-2">
                        <div class="field">
                          <label>to</label>
                          <p-calendar [(ngModel)]="endDate" (onSelect)="applyFilters()" dateFormat="yy-mm-dd"
                            placeholder="End Date" [showIcon]="true" appendTo="body"></p-calendar>
                        </div>
                      </div>
                    </div>
                  </div>
                </p-accordionTab>

                <!-- Genres -->
                <p-accordionTab header="Genres">
                  <div class="genres-container">
                    <button *ngFor="let genre of genres" class="genre-tag"
                      [class.active]="selectedGenres.includes(genre.id)" (click)="toggleGenre(genre.id)">
                      {{ genre.name }}
                    </button>
                  </div>
                </p-accordionTab>
              </p-accordion>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content Grid -->
    <div class="col-12">
      <div class="grid movies-grid">
        <div class="col-6 md:col-4 lg:col-3" *ngFor="let movie of movies">
          <a [href]="'/movie/' + movie.id">
            <item [itemData]="movie"></item>
          </a>
        </div>
      </div>
      <div class="paginator-container">
        <p-paginator [rows]="20" [totalRecords]="10000" (onPageChange)="paginate($event)"></p-paginator>
      </div>
    </div>
  </div>
</div>